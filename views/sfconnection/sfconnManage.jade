extends ../layouts/layout-default

block stylesheet
  link(rel='stylesheet', href='/styles/customer.css', type='text/css' )
block scripts
  script(type='text/javascript',src="/js/sfconn/sfmain.js")

block content
  if errMessage
    p #{errMessage}
  .container.well.well-lg(style="background: #ccc;")
    .page-header
      h1 
        span Salesforce Connections
        button.btn.btn-primary.btn-xs(data-toggle="modal",data-target="#newSFConnPanel",style="margin-left:10px;")
          span.glyphicon.glyphicon-plus-sign
          span(style="margin-left:6px;")
            |New connection
    for oriSFConn in SFConnections
      - var sfconnId = oriSFConn.id;
      .row
        .col-md-12.col-sm-12
          .col-md-5.col-sm-5
            ul.nav.nav-stacked
              li.active
                a(href="#")
                  |#{oriSFConn.name}
                  div.pull-right
                    span.badge.badge-del.sfconnDelete(style="margin-right:2px;")
                      |Delete
                    span.badge.badge-edit(data-toggle="modal",data-target='#'+sfconnId,style="margin-left:2px;margin-right:2px;")
                      |Edit
                    span.badge.badge-signIn.sfchangeSet(style="margin-left:2px;")
                      |Changesets
                    span.badge.badge-signIn.sffileSync(style="margin-left:4px;")
                      |SyncFiles
          .col-md-7.col-sm-7(style="margin-top: 10px;")
            p
              |SyncFileStatus : #{oriSFConn.syncFileStatus} , lastFileSyncDate : #{oriSFConn.lastFileSyncDate}
        .modal.fade(id=sfconnId,tabindex="-1",role="dialog",aria-labelledby="myModalLabel",aria-hidden="true")
          .modal-dialog
            .modal-content
              .modal-header
                button.close(type="button",data-dismiss="modal",aria-hidden="true") &times;
                h4.modal-title SFConnection
                  small &nbsp;Edit
              .modal-body
                form.form-horizontal.sfconnEditForm(role="form",action="/sfconn/"+sfconnId,method="post")
                  input(type="hidden",value="put",name="_method")
                  .form-group
                    label.col-sm-3.control-label E-mail 
                    .col-sm-8
                      input.form-control(name="username",type="email",placeholder="Username",value="#{oriSFConn.username}") 
                  .form-group
                    label.col-sm-3.control-label SFConn Name
                    .col-sm-8
                      input.form-control(name="connName",type="text",placeholder="Connection Name",value="#{oriSFConn.name}")
                  .form-group
                    label.col-sm-3.control-label Password 
                    .col-sm-8
                      input.form-control(name="password",type="password",placeholder="Password",value="#{oriSFConn.password}")
                  .form-group
                    label.col-sm-3.control-label Secure Token 
                    .col-sm-8
                      input.form-control(name="secureToken",type="password",placeholder="Secure Token",value="#{oriSFConn.secureToken}")
                  .form-group
                    label.col-sm-3.control-label ENV Model
                    .col-sm-8
                      select.form-control(name="endpoint",value="#{oriSFConn.conn_env}")
                        option.form-control(value="test.salesforce.com") sandbox
                        if oriSFConn.conn_env=='login.salesforce.com'
                          option.form-control(value="login.salesforce.com",selected='selected') production
                        else
                          option.form-control(value="login.salesforce.com") production
                  .form-group
                    .validInfo.alert.alert-success.col-sm-8.col-sm-offset-3(style='display:none;').
                        You org connects well.
                    .unValideInfo.alert.alert-danger.col-sm-8.col-sm-offset-3(style='display:none;').
                        Can't connect to Salesforce.Please check your input infos.
                    .col-sm-offset-3.col-sm-8(style="text-align: right;")
                      button.connValidate.btn.btn-warning(type="button",style="margin-right: 10px;") Validate
                      button.btn.btn-primary(type="submit",style="margin-right: 10px;") Save
  include newSFConn